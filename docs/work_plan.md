# Plan de Trabajo - Backend Sistema de Inventarios MVP

## üìã Resumen Ejecutivo

**Objetivo**: Desarrollar el backend de un sistema de inventarios multi-tenant siguiendo **Domain-Driven Design (DDD)**, **Arquitectura Hexagonal** y **Programaci√≥n Funcional**, con gesti√≥n completa de usuarios, permisos basados en roles (RBAC), autenticaci√≥n JWT y personalizaci√≥n de marca.

**Duraci√≥n Estimada**: 10-12 semanas
**Equipo**: 2-3 desarrolladores Backend (DDD + FP)
**Metodolog√≠a**: Agile/Scrum con sprints de 2 semanas
**Arquitectura**: Hexagonal + DDD + Programaci√≥n Funcional + Screaming Architecture + NestJS

---

## üéØ Fases del Proyecto

### **FASE 1: Arquitectura Hexagonal y DDD (Semanas 1-3)**

### **FASE 2: Dominio de Autenticaci√≥n y Usuarios (Semanas 4-6)**

### **FASE 3: Dominio de Inventarios (Semanas 7-9)**

### **FASE 4: Dominio de Reportes e Importaciones (Semanas 10-11)**

### **FASE 5: Testing, Optimizaci√≥n y Despliegue (Semana 12)**

---

## üèóÔ∏è FASE 1: Arquitectura Hexagonal, DDD y Screaming Architecture üöß **EN PROGRESO**

### **Semana 1: Setup del Proyecto y Arquitectura Base** ‚úÖ **COMPLETADA**

- [x] **Configuraci√≥n del entorno de desarrollo**
  - [x] Setup de repositorio Git con estructura de ramas (main, dev, feature/\*)
  - [x] Configuraci√≥n de Docker para desarrollo local (docker-compose.yml)
  - [x] Setup de base de datos PostgreSQL 15+ con Docker
  - [x] Configuraci√≥n de herramientas de linting y testing
  - [x] Setup de Node.js 18+ y npm/yarn

- [x] **Arquitectura Hexagonal y Screaming Architecture**
  - [x] Crear estructura de carpetas siguiendo Screaming Architecture
  - [x] Configuraci√≥n de TypeScript con strict mode y paths
  - [x] Setup de ESLint, Prettier, Husky para pre-commit hooks
  - [x] Configuraci√≥n de Jest para testing funcional
  - [x] Crear archivos de configuraci√≥n base (tsconfig.json, .eslint.config.mjs)

- [x] **Setup de NestJS**
  - [x] Instalaci√≥n de NestJS CLI y dependencias base
  - [x] Configuraci√≥n de nest-cli.json con estructura personalizada
  - [x] Setup de m√≥dulo principal (app.module.ts)
  - [x] Configuraci√≥n de main.ts con validaci√≥n global
  - [x] Crear estructura base de m√≥dulos por dominio

### **Semana 2: Dominios y Entidades del Core** ‚úÖ **COMPLETADA**

- [x] **Definici√≥n de Dominios DDD con Screaming Architecture**
  - [x] Identificaci√≥n de Bounded Contexts (Auth, Inventory, Reports, Organization)
  - [x] Definici√≥n de Entidades, Value Objects y Aggregates por dominio
  - [x] Implementaci√≥n de Repositories interfaces (ports)
  - [x] Setup de Domain Events y Domain Services
  - [x] Crear estructura que "grita" el dominio del inventario

- [x] **Configuraci√≥n de Base de Datos**
  - [x] Scripts de migraci√≥n siguiendo DDD con Prisma
  - [x] Implementaci√≥n de √≠ndices y restricciones de integridad
  - [x] Crear vistas materializadas (`v_inventory_balance`, `v_low_stock`)
  - [x] Setup de seeds para datos de prueba por dominio
  - [x] Configuraci√≥n de conexiones multi-tenant

- [x] **Implementaci√≥n de Entidades Base**
  - [x] Crear entidades base (BaseEntity, BaseAggregate)
  - [x] Implementar Value Objects inmutables
  - [x] Setup de Domain Events base
  - [x] Crear interfaces de Repository base
  - [x] Implementar decoradores personalizados para validaci√≥n

### **Semana 3: Infraestructura y Adaptadores** ‚úÖ **COMPLETADA**

- [x] **Implementaci√≥n de Arquitectura Hexagonal**
  - [x] Setup de adaptadores de entrada (HTTP Controllers, CLI Commands)
  - [x] Implementaci√≥n de adaptadores de salida (PostgreSQL, Redis)
  - [x] Configuraci√≥n de inyecci√≥n de dependencias con NestJS
  - [x] Tests de integraci√≥n multi-tenant
  - [x] Crear interfaces de ports para cada adaptador

- [x] **Configuraci√≥n Multi-Tenant**
  - [x] Middleware de detecci√≥n de organizaci√≥n por subdominio/header
  - [x] Validaci√≥n de `org_id` en todos los endpoints
  - [x] Configuraci√≥n de conexiones por organizaci√≥n
  - [x] Implementaci√≥n de Tenant Context con decoradores personalizados
  - [x] Tests de integraci√≥n multi-tenant

- [x] **Setup de Infraestructura Base**
  - [x] Configuraci√≥n de Prisma con m√∫ltiples conexiones
  - [x] Setup de Redis para cach√© y sesiones
  - [x] Implementaci√≥n de adaptadores base (BaseRepository, BaseService)
  - [x] Crear interceptores globales para logging y auditor√≠a
  - [x] Setup de filtros de excepci√≥n globales

---

## üîê FASE 2: Dominio de Autenticaci√≥n y Usuarios

### **Semana 4: Dominio de Autenticaci√≥n**

- [x] **Implementaci√≥n del Dominio de Auth**
  - [x] Entidades: User, Role, Permission, Session con decoradores NestJS
  - [x] Value Objects: Email, Password, JWT Token (inmutables)
  - [x] Domain Services: AuthenticationService, AuthorizationService
  - [x] Domain Events: UserCreated, UserLoggedIn, PermissionChanged
  - [x] Crear interfaces de Repository para cada entidad

- [x] **Casos de Uso de Autenticaci√≥n**
  - [x] Login, Logout, Refresh Token con JWT
  - [x] Validaci√≥n de contrase√±as con bcrypt (salt rounds: 12)
  - [x] Blacklisting de tokens con Redis
  - [x] Rate limiting funcional por IP y usuario
  - [x] Implementar guards de autenticaci√≥n

- [ ] **Setup de Seguridad Base**
  - [x] Configuraci√≥n de Passport JWT Strategy
  - [x] Implementar guards de autorizaci√≥n por roles
  - [x] Crear interceptores para logging de autenticaci√≥n
  - [x] Setup de validaci√≥n de entrada con class-validator
  - [ ] Tests unitarios para todos los servicios de autenticaci√≥n

### **Semana 5: Dominio de Usuarios y RBAC**

- [ ] **Implementaci√≥n del Dominio de Usuarios**
  - [ ] Aggregates: UserAggregate, RoleAggregate con reglas de consistencia
  - [ ] Domain Services: UserManagementService, RoleAssignmentService
  - [ ] Value Objects: Username, UserStatus, RoleName (inmutables)
  - [ ] Domain Events: RoleAssigned, UserStatusChanged, PermissionChanged
  - [ ] Crear interfaces de Repository para usuarios y roles

- [ ] **Sistema RBAC Funcional**
  - [ ] Casos de uso: CreateUser, AssignRole, CheckPermission
  - [ ] Implementaci√≥n de permisos granulares por m√≥dulo
  - [ ] Roles predefinidos (Admin, Operador, Consultor, Supervisor)
  - [ ] Auditor√≠a funcional de cambios con Domain Events
  - [ ] Implementar guards de autorizaci√≥n por permisos

- [ ] **Implementaci√≥n de Permisos**
  - [ ] Crear sistema de permisos granulares por m√≥dulo y acci√≥n
  - [ ] Implementar decoradores personalizados para permisos
  - [ ] Crear middleware de validaci√≥n de permisos
  - [ ] Setup de auditor√≠a autom√°tica de cambios de permisos
  - [ ] Tests de integraci√≥n para el sistema RBAC completo

### **Semana 6: Adaptadores y API de Autenticaci√≥n**

- [ ] **Implementaci√≥n de Adaptadores**
  - [ ] HTTP Controllers para endpoints de auth con decoradores NestJS
  - [ ] Middleware de autenticaci√≥n y autorizaci√≥n
  - [ ] Validaci√≥n de entrada con class-validator y DTOs
  - [ ] Tests de integraci√≥n de endpoints
  - [ ] Crear interceptores para logging y auditor√≠a

- [ ] **API REST de Autenticaci√≥n**
  - [ ] Endpoints: POST /auth/login, POST /auth/refresh, POST /auth/logout
  - [ ] Endpoints de gesti√≥n: GET /users, POST /users, PUT /users/:id
  - [ ] OpenAPI/Swagger documentation with decorators
  - [ ] Tests de aceptaci√≥n
  - [ ] Implementar rate limiting por endpoint

- [ ] **Colecci√≥n de Postman - Auth**
  - [ ] Crear colecci√≥n de Postman para autenticaci√≥n
  - [ ] Configurar variables de entorno (tokens, URLs)
  - [ ] Implementar tests automatizados para respuestas
  - [ ] Crear pre-request scripts para autenticaci√≥n autom√°tica
  - [ ] Documentar todos los endpoints de auth

---

## üì¶ FASE 3: Dominio de Inventarios

### **Semana 7: Dominio de Productos y Bodegas**

- [ ] **Implementaci√≥n del Dominio de Productos**
  - [ ] Aggregates: ProductAggregate, CategoryAggregate con reglas de consistencia
  - [ ] Value Objects: SKU, ProductName, Unit, Price (inmutables)
  - [ ] Domain Services: ProductValidationService, PricingService
  - [ ] Domain Events: ProductCreated, ProductUpdated, PriceChanged
  - [ ] Crear interfaces de Repository para productos y categor√≠as

- [ ] **Implementaci√≥n del Dominio de Bodegas**
  - [ ] Aggregates: WarehouseAggregate, LocationAggregate con reglas de consistencia
  - [ ] Value Objects: WarehouseCode, LocationCode, Address (inmutables)
  - [ ] Domain Services: WarehouseAssignmentService
  - [ ] Domain Events: WarehouseCreated, LocationAdded
  - [ ] Crear interfaces de Repository para bodegas y ubicaciones

- [ ] **Setup de Validaciones de Dominio**
  - [ ] Implementar validaciones de SKU √∫nico por organizaci√≥n
  - [ ] Crear reglas de negocio para productos y bodegas
  - [ ] Setup de Domain Events para auditor√≠a autom√°tica
  - [ ] Tests unitarios para todos los servicios de dominio
  - [ ] Crear factories para entidades de prueba

### **Semana 8: Dominio de Movimientos y Transferencias**

- [ ] **Implementaci√≥n del Dominio de Movimientos**
  - [ ] Aggregates: MovementAggregate, MovementLineAggregate con reglas de consistencia
  - [ ] Value Objects: MovementType, MovementStatus, Quantity, UnitCost (inmutables)
  - [ ] Domain Services: InventoryCalculationService, PPMService
  - [ ] Domain Events: MovementPosted, StockUpdated, PPMRecalculated
  - [ ] Crear interfaces de Repository para movimientos

- [ ] **Implementaci√≥n del Dominio de Transferencias**
  - [ ] Aggregates: TransferAggregate, TransferLineAggregate con reglas de consistencia
  - [ ] Value Objects: TransferStatus, TransferDirection (inmutables)
  - [ ] Domain Services: TransferValidationService, TransferWorkflowService
  - [ ] Domain Events: TransferInitiated, TransferReceived, TransferRejected
  - [ ] Crear interfaces de Repository para transferencias

- [ ] **Implementaci√≥n de Reglas de Negocio**
  - [ ] Validaci√≥n de stock disponible antes de salidas
  - [ ] C√°lculo autom√°tico de PPM (Promedio Ponderado M√≥vil)
  - [ ] Implementar workflow de estados para transferencias
  - [ ] Crear servicios de auditor√≠a autom√°tica
  - [ ] Tests de integraci√≥n para flujos completos

### **Semana 9: Reglas de Negocio y Casos de Uso**

- [ ] **Implementaci√≥n de Reglas de Negocio**
  - [ ] Domain Services: StockValidationService, AlertService
  - [ ] Value Objects: MinQuantity, MaxQuantity, SafetyStock (inmutables)
  - [ ] Business Rules: NoNegativeStock, UniqueSKU, MandatoryAudit
  - [ ] Domain Events: LowStockAlert, StockThresholdExceeded
  - [ ] Crear servicios de notificaci√≥n autom√°tica

- [ ] **Casos de Uso del Inventario**
  - [ ] Use Cases: CreateProduct, PostMovement, InitiateTransfer
  - [ ] Application Services: ProductApplicationService, MovementApplicationService
  - [ ] Command/Query Handlers funcionales con CQRS
  - [ ] Tests de reglas de negocio
  - [ ] Implementar validaciones de entrada con DTOs

- [ ] **Implementaci√≥n de Alertas y Notificaciones**
  - [ ] Crear sistema de alertas de stock bajo
  - [ ] Implementar notificaciones por email/websocket
  - [ ] Crear dashboard de alertas en tiempo real
  - [ ] Setup de jobs programados para validaciones
  - [ ] Tests de integraci√≥n para el sistema de alertas

### **Semana 10: Adaptadores y API de Inventarios**

- [ ] **Implementaci√≥n de Adaptadores de Inventario**
  - [ ] HTTP Controllers para productos, bodegas y movimientos con NestJS
  - [ ] Middleware de validaci√≥n de permisos por m√≥dulo
  - [ ] Validaci√≥n de entrada con DTOs y class-validator
  - [ ] Tests de integraci√≥n de endpoints
  - [ ] Crear interceptores para logging y auditor√≠a

- [ ] **API REST de Inventarios**
  - [ ] Endpoints: GET /products, POST /products, PUT /products/:id
  - [ ] Endpoints: GET /warehouses, POST /movements, POST /transfers
  - [ ] OpenAPI/Swagger documentation with decorators
  - [ ] Tests de aceptaci√≥n funcionales
  - [ ] Implementar paginaci√≥n y filtros avanzados

- [ ] **Colecci√≥n de Postman - Inventory**
  - [ ] Crear colecci√≥n de Postman para inventarios
  - [ ] Configurar variables de entorno para datos de prueba
  - [ ] Implementar tests automatizados para validaciones
  - [ ] Crear pre-request scripts para setup de datos
  - [ ] Documentar todos los endpoints de inventario

---

## üìä FASE 4: Dominio de Reportes e Importaciones

### **Semana 11: Dominio de Reportes e Importaciones**

- [ ] **Implementaci√≥n del Dominio de Reportes**
  - [ ] Aggregates: ReportAggregate, ReportTemplateAggregate con reglas de consistencia
  - [ ] Value Objects: ReportType, ReportFormat, ReportParameters (inmutables)
  - [ ] Domain Services: ReportGenerationService, ExportService
  - [ ] Domain Events: ReportGenerated, ExportCompleted
  - [ ] Crear interfaces de Repository para reportes

- [ ] **Implementaci√≥n del Dominio de Importaciones**
  - [ ] Aggregates: ImportBatchAggregate, ImportRowAggregate con reglas de consistencia
  - [ ] Value Objects: ImportType, ImportStatus, ValidationResult (inmutables)
  - [ ] Domain Services: ImportValidationService, ImportProcessingService
  - [ ] Domain Events: ImportStarted, ImportValidated, ImportCompleted
  - [ ] Crear interfaces de Repository para importaciones

- [ ] **Setup de Procesamiento de Archivos**
  - [ ] Implementar validaci√≥n de archivos Excel/CSV
  - [ ] Crear sistema de procesamiento por lotes
  - [ ] Setup de validaciones de datos de entrada
  - [ ] Implementar sistema de reportes de errores
  - [ ] Tests de integraci√≥n para importaciones y reportes

### **Semana 12: Adaptadores y API de Reportes**

- [ ] **Implementaci√≥n de Adaptadores de Reportes**
  - [ ] HTTP Controllers para generaci√≥n y exportaci√≥n con NestJS
  - [ ] Middleware de permisos para reportes sensibles
  - [ ] Validaci√≥n de par√°metros de reporte con DTOs
  - [ ] Tests de integraci√≥n
  - [ ] Crear interceptores para logging de reportes

- [ ] **API REST de Reportes e Importaciones**
  - [ ] Endpoints: GET /reports/inventory, GET /reports/movements
  - [ ] Endpoints: POST /imports/products, GET /imports/:id/status
  - [ ] Exportaci√≥n: GET /reports/:id/export?format=pdf
  - [ ] Documentaci√≥n y tests de aceptaci√≥n
  - [ ] Implementar streaming para reportes grandes

- [ ] **Colecci√≥n de Postman - Reports & Imports**
  - [ ] Crear colecci√≥n de Postman para reportes e importaciones
  - [ ] Configurar variables para diferentes tipos de reporte
  - [ ] Implementar tests para validaci√≥n de exportaciones
  - [ ] Crear scripts para testing de importaciones masivas
  - [ ] Documentar todos los endpoints de reportes e importaciones

### **Semana 13: Dominio de Personalizaci√≥n y Configuraci√≥n**

- [ ] **Implementaci√≥n del Dominio de Personalizaci√≥n**
  - [ ] Aggregates: OrganizationBrandingAggregate, UserPreferencesAggregate
  - [ ] Value Objects: BrandColors, LogoURL, ThemeSettings (inmutables)
  - [ ] Domain Services: BrandingService, ThemeService
  - [ ] Domain Events: BrandingUpdated, ThemeChanged
  - [ ] Crear interfaces de Repository para branding y preferencias

- [ ] **Implementaci√≥n del Dominio de Configuraci√≥n**
  - [ ] Aggregates: OrganizationSettingsAggregate, NotificationSettingsAggregate
  - [ ] Value Objects: Timezone, Currency, DateFormat (inmutables)
  - [ ] Domain Services: ConfigurationService, NotificationService
  - [ ] Domain Events: SettingsUpdated, NotificationConfigured
  - [ ] Crear interfaces de Repository para configuraciones

- [ ] **Setup de Sistema de Temas**
  - [ ] Implementar generaci√≥n din√°mica de CSS
  - [ ] Crear sistema de validaci√≥n de colores y fuentes
  - [ ] Setup de almacenamiento de logos y assets
  - [ ] Implementar sistema de notificaciones configurables
  - [ ] Tests de integraci√≥n para personalizaci√≥n

---

## üé® FASE 5: Testing, Optimizaci√≥n y Despliegue

### **Semana 14: Testing y Optimizaci√≥n**

- [ ] **Testing Completo del Sistema**
  - [ ] Tests unitarios con Jest (m√≠nimo 90% coverage)
  - [ ] Tests de integraci√≥n para todos los dominios
  - [ ] Tests de aceptaci√≥n para casos de uso
  - [ ] Tests de performance y carga
  - [ ] Tests de seguridad y permisos

- [ ] **Optimizaci√≥n y Refactoring**
  - [ ] Optimizaci√≥n de consultas SQL con Prisma
  - [ ] Implementaci√≥n de cach√© funcional con Redis
  - [ ] Refactoring de c√≥digo siguiendo principios FP
  - [ ] Optimizaci√≥n de memoria y CPU
  - [ ] Implementar lazy loading para entidades pesadas

- [ ] **Testing de Postman**
  - [ ] Ejecutar todos los tests de Postman autom√°ticamente
  - [ ] Validar cobertura de endpoints en todas las colecciones
  - [ ] Crear tests de regresi√≥n para funcionalidades cr√≠ticas
  - [ ] Documentar casos de prueba exitosos
  - [ ] Setup de CI/CD para testing autom√°tico de Postman

### **Semana 15: Despliegue y Documentaci√≥n**

- [ ] **Despliegue del Sistema**
  - [ ] Configuraci√≥n de producci√≥n con Docker y Docker Compose
  - [ ] Setup de CI/CD con GitHub Actions
  - [ ] Despliegue en staging y producci√≥n
  - [ ] Configuraci√≥n de monitoreo y logs
  - [ ] Setup de health checks y m√©tricas

- [ ] **Documentaci√≥n T√©cnica**
  - [ ] Documentaci√≥n de la arquitectura DDD y Hexagonal
  - [ ] API Guide with OpenAPI/Swagger
  - [ ] Manual de desarrollo y contribuci√≥n
  - [ ] Documentaci√≥n de despliegue
  - [ ] Gu√≠a de uso de la colecci√≥n de Postman

- [ ] **Finalizaci√≥n de Postman**
  - [ ] Consolidar todas las colecciones en una sola
  - [ ] Crear documentaci√≥n completa de endpoints
  - [ ] Configurar entornos para diferentes ambientes
  - [ ] Implementar tests de smoke para validaci√≥n r√°pida
  - [ ] Crear gu√≠a de usuario para testing con Postman

### **Semana 16: Finalizaci√≥n y Entrega**

- [ ] **Finalizaci√≥n del MVP**
  - [ ] Revisi√≥n completa del sistema
  - [ ] Validaci√≥n de todos los casos de uso
  - [ ] Performance testing final
  - [ ] Preparaci√≥n para entrega
  - [ ] Validaci√≥n de cobertura de tests

- [ ] **Entrega y Transici√≥n**
  - [ ] Demo del sistema completo
  - [ ] Entrega de documentaci√≥n t√©cnica
  - [ ] Capacitaci√≥n del equipo de operaciones
  - [ ] Plan de mantenimiento y evoluci√≥n
  - [ ] Entrega de colecci√≥n de Postman completa

- [ ] **Validaci√≥n Final de Postman**
  - [ ] Ejecutar suite completa de tests de Postman
  - [ ] Validar funcionamiento en todos los entornos
  - [ ] Crear documentaci√≥n de troubleshooting
  - [ ] Entregar gu√≠a de mantenimiento de la colecci√≥n
  - [ ] Capacitar equipo en uso de Postman para testing

---

## üõ†Ô∏è Stack Tecnol√≥gico Backend

### **Runtime y Lenguaje**

- **Runtime**: Node.js 18+ con TypeScript (strict mode)
- **Paradigma**: Programaci√≥n Funcional + DDD
- **Framework**: NestJS con arquitectura hexagonal y DDD
- **Validaci√≥n**: Class-validator + Joi o Zod para esquemas funcionales
- **Testing**: Jest + Supertest + TestContainers

### **Arquitectura y Patrones**

- **Arquitectura**: Hexagonal (Ports & Adapters) + Screaming Architecture + NestJS
- **DDD**: Bounded Contexts, Aggregates, Value Objects
- **Patrones**: Repository, Factory, Command/Query Handler
- **Event Sourcing**: Domain Events y Event Store
- **CQRS**: Separaci√≥n de comandos y consultas
- **Screaming Architecture**: Estructura que "grita" el dominio del inventario
- **NestJS**: Decorators, Dependency Injection, Modules, Guards, Interceptors

### **Base de Datos y Persistencia**

- **Base de Datos**: PostgreSQL 15+ con transacciones
- **ORM**: Prisma con repositorios personalizados
- **Migraciones**: Prisma Migrate con versionado
- **Cach√©**: Redis para sesiones y datos frecuentes
- **Event Store**: PostgreSQL para domain events

### **Seguridad y Autenticaci√≥n**

- **JWT**: jsonwebtoken con refresh tokens
- **Encriptaci√≥n**: bcrypt (salt rounds: 12)
- **Rate Limiting**: express-rate-limit funcional
- **Validaci√≥n**: Sanitizaci√≥n de entrada con DOMPurify
- **Auditor√≠a**: Logging completo de todas las operaciones

### **Infraestructura y DevOps**

- **Contenedores**: Docker + Docker Compose
- **CI/CD**: GitHub Actions con testing autom√°tico
- **Monitoreo**: Winston + Prometheus + Grafana
- **Health Checks**: Endpoints de salud del sistema
- **Logging**: Structured logging con correlaci√≥n de requests

---

## üìÅ Estructura del Proyecto (NestJS + Screaming Architecture + DDD + Hexagonal)

```
inventory-system/
‚îú‚îÄ‚îÄ src/
‚îÇ   ‚îú‚îÄ‚îÄ inventory/                       # üéØ INVENTARIO (Screaming Architecture)
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ products/                    # Productos del inventario
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ entities/
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ value-objects/
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ aggregates/
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ domain-services/
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ domain-events/
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ repositories/
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ controllers/             # NestJS Controllers
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ services/                # NestJS Services
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ dto/                     # Data Transfer Objects
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ warehouses/                  # Bodegas y ubicaciones
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ entities/
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ value-objects/
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ aggregates/
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ domain-services/
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ domain-events/
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ repositories/
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ controllers/
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ services/
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ dto/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ movements/                   # Movimientos de inventario
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ entities/
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ value-objects/
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ aggregates/
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ domain-services/
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ domain-events/
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ repositories/
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ controllers/
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ services/
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ dto/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ transfers/                   # Transferencias entre bodegas
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ entities/
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ value-objects/
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ aggregates/
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ domain-services/
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ domain-events/
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ repositories/
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ controllers/
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ services/
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ dto/
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ stock/                       # Control de stock y alertas
‚îÇ   ‚îÇ       ‚îú‚îÄ‚îÄ entities/
‚îÇ   ‚îÇ       ‚îú‚îÄ‚îÄ value-objects/
‚îÇ   ‚îÇ       ‚îú‚îÄ‚îÄ aggregates/
‚îÇ   ‚îÇ       ‚îú‚îÄ‚îÄ domain-services/
‚îÇ   ‚îÇ       ‚îú‚îÄ‚îÄ domain-events/
‚îÇ   ‚îÇ       ‚îú‚îÄ‚îÄ repositories/
‚îÇ   ‚îÇ       ‚îú‚îÄ‚îÄ controllers/
‚îÇ   ‚îÇ       ‚îú‚îÄ‚îÄ services/
‚îÇ   ‚îÇ       ‚îî‚îÄ‚îÄ dto/
‚îÇ   ‚îú‚îÄ‚îÄ authentication/                  # üîê AUTENTICACI√ìN
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ users/                       # Gesti√≥n de usuarios
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ entities/
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ value-objects/
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ aggregates/
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ domain-services/
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ domain-events/
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ repositories/
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ controllers/
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ services/
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ dto/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ roles/                       # Roles y permisos
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ entities/
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ value-objects/
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ aggregates/
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ domain-services/
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ domain-events/
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ repositories/
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ controllers/
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ services/
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ dto/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ sessions/                    # Sesiones y tokens
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ entities/
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ value-objects/
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ aggregates/
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ domain-services/
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ domain-events/
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ repositories/
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ controllers/
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ services/
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ dto/
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ security/                    # Seguridad y validaci√≥n
‚îÇ   ‚îÇ       ‚îú‚îÄ‚îÄ guards/                  # NestJS Guards
‚îÇ   ‚îÇ       ‚îú‚îÄ‚îÄ interceptors/            # NestJS Interceptors
‚îÇ   ‚îÇ       ‚îú‚îÄ‚îÄ decorators/              # Custom Decorators
‚îÇ   ‚îÇ       ‚îî‚îÄ‚îÄ strategies/              # Passport Strategies
‚îÇ   ‚îú‚îÄ‚îÄ reporting/                       # üìä REPORTES
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ inventory-reports/           # Reportes de inventario
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ movement-reports/            # Reportes de movimientos
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ financial-reports/           # Reportes financieros
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ export/                      # Exportaci√≥n de datos
‚îÇ   ‚îú‚îÄ‚îÄ imports/                         # üì• IMPORTACIONES
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ batch-processing/            # Procesamiento por lotes
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ validation/                  # Validaci√≥n de datos
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ templates/                   # Plantillas de importaci√≥n
‚îÇ   ‚îú‚îÄ‚îÄ organization/                    # üè¢ ORGANIZACI√ìN
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ branding/                    # Personalizaci√≥n de marca
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ settings/                    # Configuraciones
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ multi-tenancy/               # Multi-tenant
‚îÇ   ‚îú‚îÄ‚îÄ application/                     # üöÄ Casos de Uso
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ inventory-use-cases/         # Casos de uso de inventario
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ auth-use-cases/              # Casos de uso de autenticaci√≥n
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ reporting-use-cases/         # Casos de uso de reportes
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ import-use-cases/            # Casos de uso de importaciones
‚îÇ   ‚îú‚îÄ‚îÄ infrastructure/                  # üîå Adaptadores de Salida
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ database/                    # Base de datos
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ prisma/
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ repositories/
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ migrations/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ cache/                       # Redis
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ storage/                     # Almacenamiento de archivos
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ external-services/           # Servicios externos
‚îÇ   ‚îú‚îÄ‚îÄ interfaces/                      # üåê Adaptadores de Entrada
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ http/                        # API REST
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ middlewares/             # Global Middlewares
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ filters/                 # Exception Filters
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ pipes/                   # Validation Pipes
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ routes/                  # Route Definitions
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ cli/                         # Comandos CLI
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ websockets/                  # WebSockets (futuro)
‚îÇ   ‚îú‚îÄ‚îÄ shared/                          # üõ†Ô∏è Utilidades Compartidas
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ domain/                      # Dominio compartido
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ utils/                       # Utilidades generales
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ errors/                      # Manejo de errores
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ types/                       # Tipos compartidos
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ decorators/                  # Custom Decorators
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ interceptors/                # Global Interceptors
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ constants/                   # Constantes del sistema
‚îÇ   ‚îú‚îÄ‚îÄ app.module.ts                    # üöÄ M√≥dulo principal
‚îÇ   ‚îú‚îÄ‚îÄ main.ts                          # üöÄ Punto de entrada
‚îÇ   ‚îî‚îÄ‚îÄ app.controller.ts                # üöÄ Controller principal
‚îú‚îÄ‚îÄ prisma/                              # üìä Esquemas de BD
‚îú‚îÄ‚îÄ tests/                               # üß™ Tests
‚îÇ   ‚îú‚îÄ‚îÄ unit/
‚îÇ   ‚îú‚îÄ‚îÄ integration/
‚îÇ   ‚îú‚îÄ‚îÄ acceptance/
‚îÇ   ‚îî‚îÄ‚îÄ fixtures/
‚îú‚îÄ‚îÄ docs/                                # üìö Documentaci√≥n
‚îú‚îÄ‚îÄ postman/                             # üìÆ Colecci√≥n de Postman
‚îÇ   ‚îú‚îÄ‚îÄ Inventory-System.postman_collection.json
‚îÇ   ‚îú‚îÄ‚îÄ environments/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ local.postman_environment.json
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ staging.postman_environment.json
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ production.postman_environment.json
‚îÇ   ‚îî‚îÄ‚îÄ data/
‚îÇ       ‚îú‚îÄ‚îÄ test-data.json
‚îÇ       ‚îî‚îÄ‚îÄ sample-requests.json
‚îú‚îÄ‚îÄ docker/                              # üê≥ Configuraci√≥n Docker
‚îú‚îÄ‚îÄ scripts/                             # üîß Scripts de utilidad
‚îú‚îÄ‚îÄ nest-cli.json                        # ‚öôÔ∏è Configuraci√≥n NestJS
‚îú‚îÄ‚îÄ tsconfig.json                        # ‚öôÔ∏è Configuraci√≥n TypeScript
‚îú‚îÄ‚îÄ package.json                         # üì¶ Dependencias
‚îî‚îÄ‚îÄ README.md                            # üìö Documentaci√≥n del proyecto
```

---

## üîí Consideraciones de Seguridad

### **Autenticaci√≥n**

- JWT con expiraci√≥n configurable (15 min por defecto)
- Refresh tokens con expiraci√≥n extendida (7 d√≠as)
- Blacklisting de tokens en logout
- Rate limiting por IP y usuario

### **Autorizaci√≥n**

- Permisos granulares por m√≥dulo y acci√≥n
- Validaci√≥n de `org_id` en todas las operaciones
- Middleware de autorizaci√≥n en cada endpoint
- Auditor√≠a completa de cambios de permisos

### **Datos**

- Encriptaci√≥n de contrase√±as con bcrypt (salt rounds: 12)
- Validaci√≥n de entrada en todos los endpoints
- Sanitizaci√≥n de datos antes de almacenar
- Logs de auditor√≠a sin informaci√≥n sensible

---

## üìà M√©tricas de √âxito

### **Funcionales**

- ‚úÖ Sistema multi-tenant funcionando
- ‚úÖ Autenticaci√≥n JWT implementada
- ‚úÖ RBAC con permisos granulares
- ‚úÖ Gesti√≥n completa de inventarios
- ‚úÖ Importaciones masivas funcionando
- ‚úÖ Personalizaci√≥n de marca por organizaci√≥n

### **No Funcionales**

- ‚ö° Tiempo de respuesta < 2 segundos
- üîí 100% de endpoints protegidos
- üìä Cobertura de tests > 80%
- üöÄ Soporte para 200+ usuarios concurrentes
- üíæ Escalabilidad a 50+ bodegas

---

## üö® Riesgos y Mitigaciones

### **Riesgos T√©cnicos**

- **Riesgo**: Complejidad del modelo multi-tenant
  - **Mitigaci√≥n**: Implementaci√≥n incremental, tests exhaustivos

- **Riesgo**: Performance con m√∫ltiples organizaciones
  - **Mitigaci√≥n**: √çndices optimizados, vistas materializadas

### **Riesgos de Seguridad**

- **Riesgo**: Vulnerabilidades en JWT
  - **Mitigaci√≥n**: Implementaci√≥n est√°ndar, rotaci√≥n de secretos

- **Riesgo**: Acceso no autorizado entre organizaciones
  - **Mitigaci√≥n**: Validaci√≥n estricta de `org_id`, tests de penetraci√≥n

---

## üìÖ Cronograma Detallado

| Semana | Fase                   | Entregables                                | Responsable      |
| ------ | ---------------------- | ------------------------------------------ | ---------------- |
| 1      | Arquitectura Hexagonal | Setup del proyecto, estructura DDD         | DevOps + Backend |
| 2      | Arquitectura Hexagonal | Dominios y entidades del core              | Backend          |
| 3      | Arquitectura Hexagonal | Infraestructura y adaptadores              | Backend          |
| 4      | Dominio de Auth        | Dominio de autenticaci√≥n y casos de uso    | Backend          |
| 5      | Dominio de Auth        | Dominio de usuarios y RBAC                 | Backend          |
| 6      | Dominio de Auth        | Adaptadores y API de autenticaci√≥n         | Backend          |
| 7      | Dominio de Inventarios | Dominio de productos y bodegas             | Backend          |
| 8      | Dominio de Inventarios | Dominio de movimientos y transferencias    | Backend          |
| 9      | Dominio de Inventarios | Reglas de negocio y casos de uso           | Backend          |
| 10     | Dominio de Inventarios | Adaptadores y API de inventarios           | Backend          |
| 11     | Dominio de Reportes    | Dominio de reportes e importaciones        | Backend          |
| 12     | Dominio de Reportes    | Adaptadores y API de reportes              | Backend          |
| 13     | Personalizaci√≥n        | Dominio de personalizaci√≥n y configuraci√≥n | Backend          |
| 14     | Testing y Optimizaci√≥n | Testing completo y optimizaci√≥n            | Backend          |
| 15     | Despliegue             | Despliegue y documentaci√≥n t√©cnica         | DevOps + Backend |
| 16     | Finalizaci√≥n           | Finalizaci√≥n del MVP y entrega             | Equipo completo  |

---

## üéØ Principios de DDD, Programaci√≥n Funcional y Screaming Architecture

### **Screaming Architecture**

- **Dominio Primero**: La estructura de carpetas "grita" el dominio del negocio
- **Inventario como Core**: `inventory/` es la carpeta principal que domina la estructura
- **Nombres Expl√≠citos**: Carpetas como `products/`, `warehouses/`, `movements/` son claras
- **Jerarqu√≠a del Negocio**: La estructura refleja la jerarqu√≠a del dominio de inventarios
- **Visibilidad del Dominio**: Cualquier desarrollador ve inmediatamente que es un sistema de inventarios

### **Domain-Driven Design (DDD)**

- **Bounded Contexts**: Separaci√≥n clara entre dominios (Auth, Inventory, Reports)
- **Aggregates**: Agregados con ra√≠ces bien definidas y reglas de consistencia
- **Value Objects**: Objetos inmutables que representan conceptos del dominio
- **Domain Services**: Servicios que encapsulan l√≥gica de negocio compleja
- **Domain Events**: Eventos que representan cambios significativos en el dominio
- **Repository Pattern**: Abstracci√≥n de la persistencia de datos

### **Programaci√≥n Funcional**

- **Inmutabilidad**: Todos los objetos de valor y entidades son inmutables
- **Funciones Puras**: Sin efectos secundarios, determin√≠sticas
- **Composici√≥n de Funciones**: Construcci√≥n de funcionalidad compleja
- **Pattern Matching**: Uso de destructuring y match expressions
- **Monads**: Manejo de efectos secundarios (Maybe, Either, Result)
- **Currying**: Aplicaci√≥n parcial de funciones

### **Arquitectura Hexagonal**

- **Ports**: Interfaces que define el dominio
- **Adapters**: Implementaciones concretas de los ports
- **Dependency Inversion**: El dominio no depende de la infraestructura
- **Testability**: F√°cil testing con mocks y stubs
- **Flexibility**: Cambio de tecnolog√≠as sin afectar el dominio

### **NestJS Framework**

- **Decorators**: Anotaciones para controllers, services y m√≥dulos
- **Dependency Injection**: Inyecci√≥n autom√°tica de dependencias
- **Modules**: Organizaci√≥n modular por dominio
- **Guards**: Protecci√≥n de endpoints y validaci√≥n de permisos
- **Interceptors**: Transformaci√≥n de requests/responses
- **Pipes**: Validaci√≥n y transformaci√≥n de datos
- **Exception Filters**: Manejo centralizado de errores

---

## üìÆ Colecci√≥n de Postman y Documentaci√≥n de API

### **Estructura de la Colecci√≥n**

- **Colecci√≥n Principal**: `Inventory-System.postman_collection.json`
- **Entornos**: Local, Staging, Production
- **Datos de Prueba**: Archivos JSON con datos de ejemplo
- **Variables Globales**: Tokens, URLs base, headers comunes

### **Organizaci√≥n por Dominios**

- **Auth Collection**: Login, logout, refresh, gesti√≥n de usuarios
- **Inventory Collection**: Productos, bodegas, movimientos, transferencias
- **Reports Collection**: Reportes de inventario, exportaciones
- **Imports Collection**: Importaciones masivas, validaciones
- **Organization Collection**: Configuraci√≥n, branding, multi-tenancy

### **Caracter√≠sticas de la Colecci√≥n**

- **Tests Automatizados**: Validaci√≥n de respuestas y c√≥digos de estado
- **Variables Din√°micas**: Tokens JWT, IDs de entidades
- **Pre-request Scripts**: Setup autom√°tico de headers y autenticaci√≥n
- **Documentaci√≥n**: Descripci√≥n de cada endpoint y par√°metros
- **Ejemplos de Uso**: Requests de ejemplo para cada operaci√≥n

### **Entornos de Postman**

- **Local**: `http://localhost:3000` (desarrollo local)
- **Staging**: `https://staging-api.inventory.com` (testing)
- **Production**: `https://api.inventory.com` (producci√≥n)

---

## üîê Sistema de Permisos Detallado (RBAC)

### **Estructura de Permisos por M√≥dulo**

#### **1. M√≥dulo de Usuarios (USERS)**

- **USERS:CREATE** - Crear nuevos usuarios
- **USERS:READ** - Ver informaci√≥n de usuarios
- **USERS:READ_OWN** - Ver solo informaci√≥n propia
- **USERS:UPDATE** - Modificar informaci√≥n de usuarios
- **USERS:UPDATE_OWN** - Modificar solo informaci√≥n propia
- **USERS:DELETE** - Eliminar usuarios
- **USERS:CHANGE_STATUS** - Activar/desactivar usuarios
- **USERS:RESET_PASSWORD** - Resetear contrase√±as
- **USERS:ASSIGN_ROLES** - Asignar roles a usuarios
- **USERS:VIEW_AUDIT** - Ver auditor√≠a de usuarios

#### **2. M√≥dulo de Roles y Permisos (ROLES)**

- **ROLES:CREATE** - Crear nuevos roles
- **ROLES:READ** - Ver roles existentes
- **ROLES:UPDATE** - Modificar roles
- **ROLES:DELETE** - Eliminar roles
- **ROLES:ASSIGN_PERMISSIONS** - Asignar permisos a roles
- **ROLES:VIEW_PERMISSIONS** - Ver permisos de roles
- **ROLES:COPY** - Copiar roles existentes

#### **3. M√≥dulo de Productos (PRODUCTS)**

- **PRODUCTS:CREATE** - Crear nuevos productos
- **PRODUCTS:READ** - Ver productos
- **PRODUCTS:READ_OWN_WAREHOUSE** - Ver productos de bodegas asignadas
- **PRODUCTS:UPDATE** - Modificar productos
- **PRODUCTS:UPDATE_OWN_WAREHOUSE** - Modificar productos de bodegas asignadas
- **PRODUCTS:DELETE** - Eliminar productos
- **PRODUCTS:CHANGE_STATUS** - Activar/desactivar productos
- **PRODUCTS:MANAGE_CATEGORIES** - Gestionar categor√≠as de productos
- **PRODUCTS:MANAGE_UNITS** - Gestionar unidades de medida
- **PRODUCTS:VIEW_HISTORY** - Ver historial de cambios
- **PRODUCTS:IMPORT_MASSIVE** - Importar productos masivamente

#### **4. M√≥dulo de Bodegas (WAREHOUSES)**

- **WAREHOUSES:CREATE** - Crear nuevas bodegas
- **WAREHOUSES:READ** - Ver bodegas
- **WAREHOUSES:READ_OWN** - Ver solo bodegas asignadas
- **WAREHOUSES:UPDATE** - Modificar bodegas
- **WAREHOUSES:UPDATE_OWN** - Modificar solo bodegas asignadas
- **WAREHOUSES:DELETE** - Eliminar bodegas
- **WAREHOUSES:MANAGE_LOCATIONS** - Gestionar ubicaciones dentro de bodegas
- **WAREHOUSES:ASSIGN_USERS** - Asignar usuarios a bodegas
- **WAREHOUSES:VIEW_CONFIG** - Ver configuraci√≥n de bodegas

#### **5. M√≥dulo de Movimientos (MOVEMENTS)**

- **MOVEMENTS:CREATE** - Crear movimientos de inventario
- **MOVEMENTS:CREATE_OWN_WAREHOUSE** - Crear movimientos en bodegas asignadas
- **MOVEMENTS:READ** - Ver movimientos
- **MOVEMENTS:READ_OWN_WAREHOUSE** - Ver movimientos de bodegas asignadas
- **MOVEMENTS:UPDATE_DRAFT** - Modificar movimientos en borrador
- **MOVEMENTS:POST** - Confirmar movimientos (cambiar estado a POSTED)
- **MOVEMENTS:VOID** - Anular movimientos
- **MOVEMENTS:VOID_OWN_WAREHOUSE** - Anular movimientos de bodegas asignadas
- **MOVEMENTS:VIEW_HISTORY** - Ver historial de movimientos
- **MOVEMENTS:APPROVE** - Aprobar movimientos que requieren autorizaci√≥n

#### **6. M√≥dulo de Transferencias (TRANSFERS)**

- **TRANSFERS:CREATE** - Crear transferencias entre bodegas
- **TRANSFERS:CREATE_FROM_OWN** - Crear transferencias desde bodegas asignadas
- **TRANSFERS:READ** - Ver transferencias
- **TRANSFERS:READ_OWN_WAREHOUSE** - Ver transferencias de bodegas asignadas
- **TRANSFERS:UPDATE_DRAFT** - Modificar transferencias en borrador
- **TRANSFERS:CONFIRM_DISPATCH** - Confirmar despacho (DRAFT ‚Üí IN_TRANSIT)
- **TRANSFERS:CONFIRM_RECEIPT** - Confirmar recepci√≥n (IN_TRANSIT ‚Üí RECEIVED)
- **TRANSFERS:REJECT** - Rechazar transferencias
- **TRANSFERS:CANCEL** - Cancelar transferencias
- **TRANSFERS:VIEW_HISTORY** - Ver historial de transferencias

#### **7. M√≥dulo de Stock (STOCK)**

- **STOCK:VIEW_BALANCE** - Ver saldos de inventario
- **STOCK:VIEW_BALANCE_OWN_WAREHOUSE** - Ver saldos de bodegas asignadas
- **STOCK:VIEW_LOW_STOCK** - Ver alertas de stock bajo
- **STOCK:VIEW_LOW_STOCK_OWN_WAREHOUSE** - Ver alertas de bodegas asignadas
- **STOCK:MANAGE_ALERTS** - Gestionar reglas de alertas de stock
- **STOCK:VIEW_VALUATION** - Ver valorizaci√≥n del inventario
- **STOCK:VIEW_VALUATION_OWN_WAREHOUSE** - Ver valorizaci√≥n de bodegas asignadas
- **STOCK:ADJUST_STOCK** - Realizar ajustes de inventario
- **STOCK:ADJUST_STOCK_OWN_WAREHOUSE** - Ajustar stock de bodegas asignadas

#### **8. M√≥dulo de Reportes (REPORTS)**

- **REPORTS:VIEW_INVENTORY** - Ver reportes de inventario
- **REPORTS:VIEW_INVENTORY_OWN_WAREHOUSE** - Ver reportes de bodegas asignadas
- **REPORTS:VIEW_MOVEMENTS** - Ver reportes de movimientos
- **REPORTS:VIEW_MOVEMENTS_OWN_WAREHOUSE** - Ver reportes de bodegas asignadas
- **REPORTS:VIEW_FINANCIAL** - Ver reportes financieros
- **REPORTS:VIEW_FINANCIAL_OWN_WAREHOUSE** - Ver reportes financieros de bodegas asignadas
- **REPORTS:EXPORT_PDF** - Exportar reportes a PDF
- **REPORTS:EXPORT_EXCEL** - Exportar reportes a Excel
- **REPORTS:EXPORT_CSV** - Exportar reportes a CSV
- **REPORTS:CREATE_CUSTOM** - Crear reportes personalizados
- **REPORTS:SHARE** - Compartir reportes con otros usuarios

#### **9. M√≥dulo de Importaciones (IMPORTS)**

- **IMPORTS:CREATE_PRODUCTS** - Crear importaciones de productos
- **IMPORTS:CREATE_STOCK** - Crear importaciones de stock
- **IMPORTS:CREATE_PRICES** - Crear importaciones de precios
- **IMPORTS:READ** - Ver importaciones
- **IMPORTS:READ_OWN_WAREHOUSE** - Ver importaciones de bodegas asignadas
- **IMPORTS:VALIDATE** - Validar importaciones
- **IMPORTS:APPLY** - Aplicar importaciones validadas
- **IMPORTS:REJECT** - Rechazar importaciones
- **IMPORTS:VIEW_HISTORY** - Ver historial de importaciones
- **IMPORTS:DOWNLOAD_TEMPLATES** - Descargar plantillas de importaci√≥n

#### **10. M√≥dulo de Organizaci√≥n (ORGANIZATION)**

- **ORGANIZATION:VIEW_SETTINGS** - Ver configuraci√≥n de la organizaci√≥n
- **ORGANIZATION:UPDATE_SETTINGS** - Modificar configuraci√≥n de la organizaci√≥n
- **ORGANIZATION:MANAGE_BRANDING** - Gestionar branding y personalizaci√≥n
- **ORGANIZATION:MANAGE_USERS** - Gestionar usuarios de la organizaci√≥n
- **ORGANIZATION:VIEW_BILLING** - Ver informaci√≥n de facturaci√≥n
- **ORGANIZATION:MANAGE_INTEGRATIONS** - Gestionar integraciones externas
- **ORGANIZATION:VIEW_ANALYTICS** - Ver analytics y m√©tricas
- **ORGANIZATION:MANAGE_NOTIFICATIONS** - Gestionar configuraciones de notificaciones

#### **11. M√≥dulo de Auditor√≠a (AUDIT)**

- **AUDIT:VIEW_LOGS** - Ver logs de auditor√≠a
- **AUDIT:VIEW_LOGS_OWN_WAREHOUSE** - Ver logs de bodegas asignadas
- **AUDIT:EXPORT_LOGS** - Exportar logs de auditor√≠a
- **AUDIT:VIEW_USER_ACTIVITY** - Ver actividad de usuarios
- **AUDIT:VIEW_SYSTEM_EVENTS** - Ver eventos del sistema
- **AUDIT:VIEW_SECURITY_EVENTS** - Ver eventos de seguridad

#### **12. M√≥dulo de Configuraci√≥n (SETTINGS)**

- **SETTINGS:VIEW_GLOBAL** - Ver configuraci√≥n global del sistema
- **SETTINGS:UPDATE_GLOBAL** - Modificar configuraci√≥n global
- **SETTINGS:VIEW_WAREHOUSE** - Ver configuraci√≥n de bodegas
- **SETTINGS:UPDATE_WAREHOUSE** - Modificar configuraci√≥n de bodegas
- **SETTINGS:MANAGE_WORKFLOWS** - Gestionar flujos de trabajo
- **SETTINGS:MANAGE_INTEGRATIONS** - Gestionar integraciones
- **SETTINGS:VIEW_LOGS** - Ver logs del sistema
- **SETTINGS:MANAGE_BACKUPS** - Gestionar respaldos

### **Roles Predefinidos con Permisos**

#### **üî¥ Administrador (ADMIN)**

- **Acceso total** a todos los m√≥dulos y permisos
- **Gesti√≥n completa** de usuarios, roles y permisos
- **Configuraci√≥n total** del sistema
- **Auditor√≠a completa** de todas las operaciones

#### **üü† Supervisor (SUPERVISOR)**

- **USERS**: READ, UPDATE_OWN
- **PRODUCTS**: CREATE, READ, UPDATE, DELETE, IMPORT_MASSIVE
- **WAREHOUSES**: READ, UPDATE_OWN, MANAGE_LOCATIONS
- **MOVEMENTS**: CREATE, READ, POST, VOID, APPROVE
- **TRANSFERS**: CREATE, READ, CONFIRM_DISPATCH, CONFIRM_RECEIPT, REJECT
- **STOCK**: Todos los permisos
- **REPORTS**: Todos los permisos
- **IMPORTS**: Todos los permisos
- **ORGANIZATION**: VIEW_SETTINGS, MANAGE_BRANDING
- **AUDIT**: VIEW_LOGS, VIEW_USER_ACTIVITY
- **SETTINGS**: VIEW_GLOBAL, VIEW_WAREHOUSE

#### **üü° Operador de Bodega (WAREHOUSE_OPERATOR)**

- **USERS**: READ_OWN, UPDATE_OWN
- **PRODUCTS**: READ_OWN_WAREHOUSE, UPDATE_OWN_WAREHOUSE
- **WAREHOUSES**: READ_OWN, UPDATE_OWN, MANAGE_LOCATIONS
- **MOVEMENTS**: CREATE_OWN_WAREHOUSE, READ_OWN_WAREHOUSE, UPDATE_DRAFT, POST
- **TRANSFERS**: CREATE_FROM_OWN, READ_OWN_WAREHOUSE, CONFIRM_RECEIPT
- **STOCK**: VIEW_BALANCE_OWN_WAREHOUSE, VIEW_LOW_STOCK_OWN_WAREHOUSE, ADJUST_STOCK_OWN_WAREHOUSE
- **REPORTS**: VIEW_INVENTORY_OWN_WAREHOUSE, VIEW_MOVEMENTS_OWN_WAREHOUSE, EXPORT_PDF, EXPORT_EXCEL
- **IMPORTS**: CREATE_PRODUCTS, CREATE_STOCK, READ_OWN_WAREHOUSE, VALIDATE, APPLY
- **ORGANIZATION**: VIEW_SETTINGS
- **AUDIT**: VIEW_LOGS_OWN_WAREHOUSE

#### **üü¢ Consultor/Auditor (CONSULTANT)**

- **USERS**: READ
- **PRODUCTS**: READ
- **WAREHOUSES**: READ
- **MOVEMENTS**: READ
- **TRANSFERS**: READ
- **STOCK**: VIEW_BALANCE, VIEW_LOW_STOCK, VIEW_VALUATION
- **REPORTS**: Todos los permisos de lectura y exportaci√≥n
- **IMPORTS**: READ, VIEW_HISTORY
- **ORGANIZATION**: VIEW_SETTINGS
- **AUDIT**: VIEW_LOGS, VIEW_USER_ACTIVITY

#### **üîµ Operador de Importaciones (IMPORT_OPERATOR)**

- **PRODUCTS**: READ, IMPORT_MASSIVE
- **IMPORTS**: CREATE_PRODUCTS, CREATE_STOCK, CREATE_PRICES, READ, VALIDATE, APPLY, DOWNLOAD_TEMPLATES
- **REPORTS**: VIEW_INVENTORY, EXPORT_EXCEL, EXPORT_CSV
- **AUDIT**: VIEW_LOGS

### **Implementaci√≥n de Permisos**

#### **Decoradores de Permisos**

```typescript
@RequirePermissions(['PRODUCTS:CREATE', 'PRODUCTS:UPDATE'])
@Controller('products')
export class ProductsController {
  // Controller implementation
}
```

#### **Guards de Autorizaci√≥n**

```typescript
@Injectable()
export class PermissionGuard implements CanActivate {
  canActivate(context: ExecutionContext): boolean {
    const requiredPermissions = this.reflector.get<string[]>('permissions', context.getHandler());
    // Validate permissions logic
  }
}
```

#### **Middleware de Validaci√≥n**

- **Validaci√≥n autom√°tica** de permisos en cada endpoint
- **Cache de permisos** del usuario (5 minutos)
- **Auditor√≠a autom√°tica** de accesos denegados
- **Rate limiting** por tipo de operaci√≥n

---

## üéØ Pr√≥ximos Pasos Inmediatos

1. ‚úÖ **Revisar y aprobar este plan de trabajo** - COMPLETADO
2. ‚úÖ **Configurar el entorno de desarrollo con TypeScript strict** - COMPLETADO
3. ‚úÖ **Crear la estructura de carpetas siguiendo Screaming Architecture + DDD + Hexagonal** - COMPLETADO
4. ‚úÖ **Implementar el dominio base del inventario como core del sistema** - COMPLETADO
5. ‚è≥ **Configurar el sistema de testing funcional** - EN PROGRESO
6. ‚úÖ **Validar que la estructura "grite" claramente el dominio del inventario** - COMPLETADO

### **üöÄ Pr√≥ximos Pasos para Semana 4**

1. **Implementar dominio de autenticaci√≥n** (User, Role, Permission entities)
2. **Crear casos de uso de autenticaci√≥n** (Login, Logout, Refresh Token)
3. **Implementar sistema RBAC** con permisos granulares
4. **Crear guards de autorizaci√≥n** por roles y permisos
5. **Implementar adaptadores de autenticaci√≥n** (HTTP Controllers)

---

## üìä M√©tricas de Control y Progreso

### **Checklist de Progreso Semanal**

- [x] **Semana 1**: Setup del proyecto y arquitectura base ‚úÖ **COMPLETADA**
- [x] **Semana 2**: Dominios y entidades del core ‚úÖ **COMPLETADA**
- [x] **Semana 3**: Infraestructura y adaptadores ‚úÖ **COMPLETADA**
- [ ] **Semana 4**: Dominio de autenticaci√≥n
- [ ] **Semana 5**: Dominio de usuarios y RBAC
- [ ] **Semana 6**: Adaptadores y API de autenticaci√≥n
- [ ] **Semana 7**: Dominio de productos y bodegas
- [ ] **Semana 8**: Dominio de movimientos y transferencias
- [ ] **Semana 9**: Reglas de negocio y casos de uso
- [ ] **Semana 10**: Adaptadores y API de inventarios
- [ ] **Semana 11**: Dominio de reportes e importaciones
- [ ] **Semana 12**: Adaptadores y API de reportes
- [ ] **Semana 13**: Dominio de personalizaci√≥n y configuraci√≥n
- [ ] **Semana 14**: Testing y optimizaci√≥n
- [ ] **Semana 15**: Despliegue y documentaci√≥n
- [ ] **Semana 16**: Finalizaci√≥n y entrega

### **Entregables por Fase**

- [x] **Fase 1**: Arquitectura base, dominios core, infraestructura ‚úÖ **COMPLETADA (100%)**
- [ ] **Fase 2**: Sistema de autenticaci√≥n completo con RBAC
- [ ] **Fase 3**: Sistema de inventarios completo
- [ ] **Fase 4**: Sistema de reportes e importaciones
- [ ] **Fase 5**: Testing, optimizaci√≥n y despliegue

### **Colecciones de Postman Completadas**

- [ ] **Auth Collection**: Autenticaci√≥n y gesti√≥n de usuarios
- [ ] **Inventory Collection**: Productos, bodegas, movimientos
- [ ] **Reports Collection**: Reportes y exportaciones
- [ ] **Imports Collection**: Importaciones masivas
- [ ] **Organization Collection**: Configuraci√≥n y personalizaci√≥n

### **üìä Estado Actual del Proyecto**

#### **‚úÖ Completado en Semana 2**

- **Arquitectura DDD**: Dominios completamente implementados
- **Screaming Architecture**: Estructura que "grita" el inventario
- **Value Objects**: Inmutables y validados por dominio
- **Entidades**: Product, Movement, Transfer, Warehouse, Location, User, Organization
- **Repositorios**: Interfaces espec√≠ficas por dominio
- **Servicios de Dominio**: C√°lculos de inventario y validaciones
- **Eventos de Dominio**: ProductCreated, MovementPosted
- **Estructura de Carpetas**: Reorganizada por dominio funcional

#### **‚úÖ Completado - Semana 3**

- **Infraestructura**: Adaptadores de entrada y salida implementados
- **Base de Datos**: Configuraci√≥n de Prisma con DDD completada
- **Multi-Tenant**: Middleware de validaci√≥n de organizaci√≥n implementado
- **Testing**: Configuraci√≥n de tests de integraci√≥n completada
- **Vistas Materializadas**: `v_inventory_balance` y `v_low_stock` implementadas
- **Decoradores**: Sistema de permisos y validaci√≥n implementado
- **Seeds**: Organizaci√≥n por dominios implementada

#### **‚è≥ Pendiente**

- **Fase 2**: Sistema de autenticaci√≥n y RBAC (Pr√≥xima semana)
- **Fase 3**: Casos de uso y APIs de inventario
- **Fase 4**: Reportes e importaciones
- **Fase 5**: Testing completo y despliegue

---

_Este plan est√° dise√±ado para un MVP funcional. Las funcionalidades avanzadas como integraciones ERP, automatizaci√≥n de compras y an√°lisis predictivo se considerar√°n para versiones futuras._
